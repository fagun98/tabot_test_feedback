# Automated Quiz Feedback Generator

This repository provides a tool for generating feedback for quizzes based on user performance and past feedback. It automatically identifies quizzes with missing feedback, retrieves past performance data, and generates detailed feedback using OpenAI's GPT model.

## Key Features

- **Identify Quizzes with Missing Feedback**: The system searches for quizzes that have no feedback and sorts them based on predefined criteria (e.g., submission date, visibility, course ID).
- **Fetch User's Past Performance**: The tool retrieves past quiz data for each user in a specific course to tailor the feedback.
- **Generate Feedback**: Feedback is generated by combining current quiz details and past performance into a template, then utilizing OpenAI's GPT model to generate personalized feedback.
- **Automatic Feedback Update**: The feedback is automatically updated in the relevant records, and the results are saved to an Excel file.

## Installation

1. Clone the repository:
    ```bash
    git clone https://github.com/your-repo/automated-feedback-generator.git
    ```

2. Install the required dependencies:
    ```bash
    pip install -r requirements.txt
    ```

3. Make sure you have access to OpenAI's API and configure your API keys accordingly.

## Usage

1. Initialize the `QuizFeedbackGenerator` with the course ID:
    ```python
    from feedback_generator import QuizFeedbackGenerator

    course_id = YOUR_COURSE_ID
    qfg = QuizFeedbackGenerator(course_id=course_id)
    ```

2. Fetch quizzes that need feedback:
    ```python
    qfg.get_quiz_to_update()
    ```

3. Generate feedback for the quizzes:
    ```python
    qfg.generate_feedback()
    ```

4. Save the updated data:
    ```python
    qfg.save_data()
    ```

## Logic Overview

- The system identifies quizzes that are ready for feedback by filtering quizzes where:
    - The submission is complete, not dropped, and visible to everyone.
    - No feedback has been given yet.
    - The quiz due date has passed.
- For each quiz, it fetches the corresponding questions and user answers.
- It retrieves the past performance of the user in the same course, including past quiz scores and feedback.
- The current quiz details and past performance are used to generate feedback, which is processed by OpenAI's GPT model.
- The generated feedback is saved back to the database and can be reviewed in an Excel file.

## Data Storage

- **Excel Storage**: All the relevant quiz and feedback data is stored in an Excel file located at `data/feedback_generator.xlsx`. It has separate sheets for:
    - Quizzes to update
    - Quiz questions and answers
    - User answers
    - User past performance

## Dependencies

- `pandas`: For data manipulation and saving to Excel files.
- `openpyxl`: For reading and writing Excel files.
- `openai`: For generating feedback through OpenAI's GPT model.
- Custom utilities: `AutomatedFeedbackTemplate` and `OpenAIChatResponse`.
